<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="AcadVault â€” secure academic certificate issuance and verification platform with tamper-resistant QR codes for R.D. & S.H. National College." />
  <meta name="theme-color" content="#0F1724" />
  <meta property="og:site_name" content="AcadVault">
  <meta property="og:type" content="website">
  <meta property="og:title" content="AcadVault â€” Secure Academic Certificate Verification">
  <meta property="og:description" content="Issue, manage, and verify academic certificates with tamper-resistant QR codes and role-based controls.">
  <meta property="og:image" content="assets/img/logo.png">
  <meta name="twitter:card" content="summary_large_image">
  <title>AcadVault â€” Secure Academic Certificate Verification</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>

  <a class="visually-hidden-focusable" href="#mainContent">Skip to content</a>

  <!-- NAVBAR -->
  <nav class="navbar navbar-expand-lg shadow-sm" role="navigation" aria-label="Primary navigation">
    <div class="container">
      <a class="navbar-brand d-flex align-items-center" href="index.html" aria-label="AcadVault home">
        <img src="assets/img/logo.png" alt="AcadVault logo" class="header-logo me-2" width="40" height="40" />
        <span class="fw-semibold">AcadVault</span>
      </a>

      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navMain"
              aria-controls="navMain" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navMain">
        <ul class="navbar-nav ms-auto align-items-lg-center">
          <li class="nav-item"><a class="nav-link active" href="index.html" aria-current="page">Home</a></li>
          <li class="nav-item"><a class="nav-link" href="verify.html">Verify</a></li>
          <li class="nav-item"><a class="nav-link" href="about.html">About</a></li>
          <li class="nav-item"><a class="nav-link" href="courses.html">Courses</a></li>
          <li class="nav-item"><a class="nav-link" href="faculty.html">Faculty</a></li>
          <li class="nav-item"><a class="nav-link" href="gallery.html">Gallery</a></li>
          <li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>

          <li class="nav-item ms-2 d-flex align-items-center">
            <button id="themeToggle" class="btn btn-sm btn-outline-secondary me-2" aria-label="Toggle theme" type="button">ðŸŒ™</button>
            <a id="loginBtn" class="btn btn-outline-primary btn-sm" href="#">Login</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- HERO -->
  <header id="mainContent" class="hero-modern" role="region" aria-labelledby="hero-heading">
    <div class="container container-sm">
      <div class="row align-items-center g-4">
        <div class="col-lg-6">
          <div class="eyebrow text-uppercase small text-muted reveal">
            R.D. &amp; S.H. National College â€¢ AcadVault
          </div>

          <h1 id="hero-heading" class="display-5 fw-bold">
            Secure Academic Certificate Verification System
          </h1>

          <p class="lead text-muted mb-4">
            Issue, manage, and verify academic certificates using tamper-resistant QR codes and role-based access control.
          </p>

          <div class="d-flex gap-2 mb-3">
            <a class="btn btn-primary btn-lg" href="about.html">How it works</a>
            <a class="btn btn-outline-primary btn-lg" href="contact.html">Request access</a>
            

          </div>

          <div class="mt-3">
            <small class="text-muted">
              Trusted by institutional departments for secure and transparent certificate workflows.
            </small>
          </div>
        </div>

        <div class="col-lg-6">
          <div class="hero-card reveal">
            <div class="hero-card-inner">
              <img src="assets/img/logo.png" alt="AcadVault preview" class="hero-preview" width="88" height="88" />
              <div class="qr-thumb ms-2">
                <img src="assets/img/qr-placeholder.png" alt="QR code preview" width="110" height="110">
              </div>
              <div class="hero-stats ms-3">
                <div><strong>10k+</strong><span class="muted d-block">Certificates Issued</span></div>
                <div class="mt-2"><strong>2.5k</strong><span class="muted d-block">Students</span></div>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </header>

  <div class="section-divider" aria-hidden="true"></div>

  <!-- FEATURES -->
  <section class="py-5">
    <div class="container container-sm">
      <h2 class="section-title text-center">Key Features</h2>

      <div class="row g-4 mt-3 reveal--stagger">
        <div class="col-sm-6 col-lg-4">
          <div class="card h-100 p-3 reveal">
            <div class="mb-2"><strong>QR-Based Verification</strong></div>
            <p class="text-muted mb-0">
              Instantly verify certificates using secure QR codes linked to live records.
            </p>
          </div>
        </div>

        <div class="col-sm-6 col-lg-4">
          <div class="card h-100 p-3 reveal">
            <div class="mb-2"><strong>Secure Digital Storage</strong></div>
            <p class="text-muted mb-0">
              Academic records are stored securely with restricted, role-based access.
            </p>
          </div>
        </div>

        <div class="col-sm-6 col-lg-4">
          <div class="card h-100 p-3 reveal">
            <div class="mb-2"><strong>Administrative Controls</strong></div>
            <p class="text-muted mb-0">
              Manage issuance, revocation, and auditing of certificates through admin dashboards.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- STATS -->
  <section class="py-4">
    <div class="container container-sm text-center reveal">
      <div class="row g-3">
        <div class="col-6 col-md-3">
          <div class="stat-card p-3">
            <div class="stat-num" data-target="10000">0</div>
            <div class="stat-label muted">Certificates</div>
          </div>
        </div>
        <div class="col-6 col-md-3">
          <div class="stat-card p-3">
            <div class="stat-num" data-target="2500">0</div>
            <div class="stat-label muted">Students</div>
          </div>
        </div>
        <div class="col-6 col-md-3">
          <div class="stat-card p-3">
            <div class="stat-num" data-target="50">0</div>
            <div class="stat-label muted">Faculty</div>
          </div>
        </div>
        <div class="col-6 col-md-3">
          <div class="stat-card p-3">
            <div class="stat-num" data-target="99" data-suffix="%">0</div>
            <div class="stat-label muted">System Uptime</div>
          </div>
        </div>
      </div>
    </div>
  </section>  <!-- End of STATS -->
  <!-- ISSUE CERTIFICATE FORM -->
<section class="py-5">
  <div class="container container-sm">
    <h2 class="text-center mb-4">Issue Certificate</h2>

    <form id="certificateForm" class="row g-3">
      <div class="col-md-4">
        <input type="text" id="studentName" class="form-control" placeholder="Student Name" required>
      </div>

      <div class="col-md-4">
        <input type="text" id="course" class="form-control" placeholder="Course" required>
      </div>

      <div class="col-md-4">
        <input type="text" id="year" class="form-control" placeholder="Year" required>
      </div>

      <div class="col-12 text-center">
        <button type="submit" class="btn btn-primary">
          Issue Certificate
        </button>
      </div>
    </form>
  </div>
</section>


<!-- LIVE CERTIFICATES -->
<section class="py-5 bg-light">
  <div class="container container-sm">
    <h2 class="text-center mb-4">Live Certificates</h2>
    <div id="certificatesContainer" class="row g-4">
      <!-- Certificates will appear here dynamically -->
    </div>
  </div>
</section>

<div class="section-divider" aria-hidden="true"></div>

<!-- CTA -->
<section class="bg-light py-4 reveal">

    <div class="container container-sm d-flex flex-column flex-md-row align-items-center justify-content-between gap-3">
      <div>
        <strong>Ready to digitize academic certificate workflows?</strong>
        <div class="text-muted">
          Begin with a single department and scale across the institution.
        </div>
      </div>
      <div>
        <a href="contact.html" class="btn btn-primary">Request Demo</a>
      </div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="text-center py-4">
    <div class="container">
      <p class="mb-1">
        Â© <span id="siteYear">2025</span> R.D. &amp; S.H. National College â€” AcadVault
      </p>
      <small class="text-muted">
        Secure Academic Verification Platform (Phase 2)
      </small>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" defer></script>
  <script src="assets/js/main.js" defer></script>

  <noscript>
    <style>.reveal { opacity: 1 !important; transform: none !important; }</style>
    <div class="container text-center py-2 small text-muted">
      JavaScript is disabled â€” interactive features may not work.
    </div>
  </noscript>

  <!-- LOGIN MODAL -->
<div class="modal fade" id="loginModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Admin Login</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body">
        <form id="loginForm">
          <div class="mb-3">
            <input type="email" id="loginEmail" class="form-control" placeholder="Email" required>
          </div>

          <div class="mb-3">
            <input type="password" id="loginPassword" class="form-control" placeholder="Password" required>
          </div>

          <button type="submit" class="btn btn-primary w-100">
            Login
          </button>
        </form>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>

<!-- ðŸ”¥ Firebase Firestore Setup -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";

import { 
  getFirestore, 
  collection, 
  addDoc, 
  getDocs,
  deleteDoc,
  doc,
  serverTimestamp,
  updateDoc
} from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

import {
  getAuth,
  signInWithEmailAndPassword,
  signOut,
  onAuthStateChanged,
}  from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCPhxMv51PyNsOwImpmz5H0CFeoNHfFoYY",
    authDomain: "acadvault-backend.firebaseapp.com",
    projectId: "acadvault-backend",
    storageBucket: "acadvault-backend.firebasestorage.app",
    messagingSenderId: "216830101670",
    appId: "1:216830101670:web:1c921497490fd47560cc67"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const auth = getAuth(app);
  

const loginBtn = document.getElementById("loginBtn");
const form = document.getElementById("certificateForm");
const formSection = form.closest("section");

loginBtn.style.visibility = "hidden";   // ðŸ‘ˆ ADD THIS LINE
formSection.style.display = "none";

// LOGIN BUTTON CLICK


const loginModal = new bootstrap.Modal(document.getElementById("loginModal"));
const loginForm = document.getElementById("loginForm");

loginBtn.addEventListener("click", async () => {
  const user = auth.currentUser;

  if (user) {
    await signOut(auth);
    alert("Logged out successfully!");
  } else {
    loginModal.show();
  }
});

loginForm.addEventListener("submit", async (e) => {
  e.preventDefault();

  const email = document.getElementById("loginEmail").value;
  const password = document.getElementById("loginPassword").value;

  if (email !== "admin@acadvault.com") {
    alert("Access denied. Only authorized admin allowed.");
    return;
  }

  try {
    // ðŸ” Set persistence BEFORE signing in

    await signInWithEmailAndPassword(auth, email, password);

    loginModal.hide();
    loginForm.reset();
  } catch (error) {
    alert("Login failed: " + error.message);
  }
});

onAuthStateChanged(auth, (user) => {
  if (user) {
    formSection.style.display = "block";
    loginBtn.textContent = "Logout";
  } else {
    formSection.style.display = "none";
    loginBtn.textContent = "Login";
  }

  fetchCertificates(); // ðŸ”¥ Force re-render
  loginBtn.style.visibility = "visible"; // ðŸ‘ˆ ADD THIS LINE
});

  const container = document.getElementById("certificatesContainer");
  

  // ISSUE CERTIFICATE
  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const studentName = document.getElementById("studentName").value;
    const course = document.getElementById("course").value;
    const year = document.getElementById("year").value;

    const docRef = await addDoc(collection(db, "certificates"), {
  studentName,
  course,
  year,
  status: "valid",
  issuedAt: serverTimestamp()
});

    alert("Certificate Issued!\nCertificate ID: " + docRef.id);

    form.reset();
    fetchCertificates();
    
  });

  // FETCH + DISPLAY
 async function fetchCertificates() {
  container.innerHTML = "";

  const querySnapshot = await getDocs(collection(db, "certificates"));

  querySnapshot.forEach((docItem) => {
  const data = docItem.data();
  const verifyUrl = `${window.location.origin}/verify.html?id=${docItem.id}`;

  // ðŸ”¥ ADD THIS BLOCK HERE
  let formattedDate = "N/A";

  if (data.issuedAt && data.issuedAt.seconds) {
    const date = new Date(data.issuedAt.seconds * 1000);
    formattedDate = date.toLocaleDateString("en-GB", {
      day: "2-digit",
      month: "short",
      year: "numeric"
    });
  }

  // Then your card template starts
  const card = `
      <div class="col-md-4">
        <div class="card shadow-sm h-100">
          <div class="card-body">
            <h5 class="card-title">${data.studentName}</h5>
            <p><strong>Course:</strong> ${data.course}</p>
<p><strong>Year:</strong> ${data.year}</p>
<p><strong>Issued On:</strong> ${formattedDate}</p>
            <p>
  <strong>Status:</strong> 
  ${
    data.status === "valid"
      ? '<span class="badge bg-success">VALID</span>'
      : '<span class="badge bg-danger">REVOKED</span>'
  }
</p>
            <p class="small text-muted">
              <strong>ID:</strong> ${docItem.id}
            </p>

            <canvas id="qr-${docItem.id}" class="mt-2"></canvas>

            ${
              auth.currentUser
                ? `<button class="btn btn-warning btn-sm mt-2 revoke-btn" data-id="${docItem.id}">
  Revoke
</button>`
                : ""
            }
          </div>
        </div>
      </div>
    `;

    container.insertAdjacentHTML("beforeend", card);

    const canvas = document.getElementById(`qr-${docItem.id}`);
    if (canvas) {
      QRCode.toCanvas(canvas, verifyUrl, { width: 100 });
    }
  });
}
container.addEventListener("click", async (e) => {
  if (e.target.classList.contains("revoke-btn")) {
    const id = e.target.getAttribute("data-id");

    if (confirm("Are you sure you want to revoke this certificate?")) {
      await updateDoc(doc(db, "certificates", id), {
        status: "revoked"
      });

      fetchCertificates();
    }
  }
});
  

  fetchCertificates();
</script>


</body>
</html>
